library(dplyr)
set.seed(998)
type2_data <- read.csv("/Users/kaimen/downloads/ScanRecords.csv")
type2_data <- type2_data[type2_data$PatientType == "Type 2", ]

#nonparametric bootstrapping func
nonparametric_bootstrap <- function(type2_data, iterations) {
  bootstrap_results <- matrix(NA, nrow = iterations, ncol = 3)  #note only 3 col
  
  for (i in 1:iterations){
    #nonparametric resampling from data rather than distribution
    resampled_data <- type2_data[sample(nrow(type2_data), replace = TRUE), ]
    
    #estimate statistics
    mean_duration <- mean(resampled_data$Duration)
    quantile_duration <- quantile(resampled_data$Duration, c(0.25, 0.75))  #some quantiles
    
    #savings in datamatrix
    bootstrap_results[i, ] <- c(mean_duration, quantile_duration)
  }
  return(bootstrap_results)
}

iterations <- 1000
bootstrap_results_type2 <- nonparametric_bootstrap(type2_data, iterations)
cat("mean duration: ", mean(bootstrap_results_type2[, 1]), "\n")
cat("25 percentile duration: ", mean(bootstrap_results_type2[, 2]), "\n")
cat("75 percentile duration: ", mean(bootstrap_results_type2[, 3]), "\n")
mean(type2_data$Duration)
sd(type2_data$Duration)
